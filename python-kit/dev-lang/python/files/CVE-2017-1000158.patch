diff -Nuar Python-2.7.13/Objects/stringobject.c Python-2.7.13-fixed/Objects/stringobject.c
--- Python-2.7.13/Objects/stringobject.c	2016-12-17 20:05:07.000000000 +0000
+++ Python-2.7.13-fixed/Objects/stringobject.c	2018-01-19 10:29:09.164294271 +0000
@@ -612,7 +612,13 @@
     char *p, *buf;
     const char *end;
     PyObject *v;
-    Py_ssize_t newlen = recode_encoding ? 4*len:len;
+	 Py_ssize_t newlen;
+	 /* Check for integer overflow */
+	 if (recode_encoding && (len > PY_SSIZE_T_MAX / 4)) {
+	     PyErr_SetString(PyExc_OverflowError, "string is too large");
+		 return NULL;
+	 } 
+	 newlen = recode_encoding ? 4*len:len;
     v = PyString_FromStringAndSize((char *)NULL, newlen);
     if (v == NULL)
         return NULL;
